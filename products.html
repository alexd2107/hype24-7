<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sneaker Inventory</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f8f9fa; color:#333; }
    header { background:#111; color:#fff; padding:1rem; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; }
    header h1 { margin:0; font-size:1.5rem; }
    header input { padding:0.5rem; border-radius:6px; border:1px solid #ccc; width:250px; max-width:100%; }
    .filters { background:#fff; padding:1rem; border-bottom:1px solid #ddd; display:flex; align-items:center; gap:1rem; flex-wrap:wrap; }
    .filters select { padding:0.5rem; border-radius:6px; border:1px solid #ccc; width:200px; max-width:100%; }
    .product-grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(220px,1fr)); gap:1rem; padding:1rem; }
    .product-card { background:#fff; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.1); padding:1rem; transition:transform 0.2s ease; text-align:center; }
    .product-card:hover { transform:translateY(-4px); box-shadow:0 4px 10px rgba(0,0,0,0.15); }
    .product-card img { width:100%; border-radius:8px; margin-bottom:10px; object-fit:cover; }
    .product-card h3 { margin:0.5rem 0 0.2rem; font-size:1.1rem; }
    .product-card p { margin:0.2rem 0; font-size:0.9rem; }
    .spinner { display:flex; justify-content:center; align-items:center; height:200px; }
    .spinner div { width:40px; height:40px; border:4px solid #ccc; border-top:4px solid #111; border-radius:50%; animation:spin 1s linear infinite; }
    @keyframes spin { 0% {transform:rotate(0deg);} 100% {transform:rotate(360deg);} }
  </style>
</head>
<body>

  <header>
    <h1>Sneaker Shop</h1>
    <input type="text" id="searchBar" placeholder="Search sneakers..." />
  </header>

  <section class="filters">
    <select id="sizeFilter">
      <option value="">All Sizes</option>
    </select>
  </section>

  <main class="product-grid">
    <div class="spinner"><div></div></div>
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script>
    const csvUrls = [
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=10727842&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=2080136486&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=184084881&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=1280515311&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=1929692327&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=1941135183&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=234881949&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=0&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=834494988&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=1649195567&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=1978474466&single=true&output=csv"
    ];

    const productGrid = document.querySelector('.product-grid');
    const sizeFilter = document.getElementById('sizeFilter');
    const searchBar = document.getElementById('searchBar');
    let allProducts = [];

    function fetchCSV(url) {
      return new Promise(resolve => {
        Papa.parse(url, {
          download: true,
          header: true,
          complete: (results) => resolve(results.data),
          error: () => resolve([])
        });
      });
    }

    async function loadProducts() {
      const mainSpinner = productGrid.innerHTML;
      const allData = await Promise.all(csvUrls.map(fetchCSV));
      allProducts = allData.flat().filter(p => p.name && p.price);

      populateSizeFilter();
      renderProducts(allProducts);
    }

    function renderProducts(products) {
      productGrid.innerHTML = '';
      if (!products.length) {
        productGrid.innerHTML = '<p>No sneakers found</p>';
        return;
      }
      products.forEach(p => {
        const card = document.createElement('div');
        card.className = 'product-card';
        card.innerHTML = `
          <img src="${p.picture || ''}" alt="${p.name}" onerror="this.style.display='none'">
          <h3>${p.name}</h3>
          <p><strong>Price:</strong> ${p.price}</p>
          <p><strong>Size:</strong> ${p.size || 'N/A'}</p>`;
        productGrid.appendChild(card);
      });
    }

    function populateSizeFilter() {
      const sizes = [...new Set(allProducts.map(p => p.size).filter(Boolean))].sort((a,b)=>parseFloat(a)-parseFloat(b));
      sizeFilter.innerHTML = '<option value="">All Sizes</option>';
      sizes.forEach(sz => {
        const opt = document.createElement('option');
        opt.value = sz;
        opt.textContent = sz;
        sizeFilter.appendChild(opt);
      });
    }

    function applyFilters() {
      const term = searchBar.value.toLowerCase();
      const sz = sizeFilter.value;
      const filtered = allProducts.filter(p =>
        p.name.toLowerCase().includes(term) &&
        (!sz || p.size.split(',').map(s => s.trim()).includes(sz))
      );
      renderProducts(filtered);
    }

    searchBar.addEventListener('input', applyFilters);
    sizeFilter.addEventListener('change', applyFilters);

    loadProducts();
  </script>
</body>
</html>
