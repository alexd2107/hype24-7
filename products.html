<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Products</title>
  <link rel="stylesheet" href="style.css"> <!-- remove if no CSS file -->
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #controls { margin-bottom: 20px; }
    .product { border: 1px solid #ddd; padding: 10px; margin-bottom: 10px; border-radius: 6px; }
    .product h3 { margin: 0; }
    .sizes { margin-top: 8px; }
  </style>
</head>
<body>
  <h1>Shop Inventory</h1>

  <div id="controls">
    <input type="text" id="search" placeholder="Search by name...">
    <select id="sizeFilter">
      <option value="">All Sizes</option>
    </select>
  </div>

  <div id="product-list"></div>

  <!-- PapaParse -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <script>
    const sheetUrls = [
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=10727842&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=2080136486&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=184084881&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=1280515311&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=1929692327&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=1941135183&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=234881949&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=0&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=834494988&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=1649195567&single=true&output=csv",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNR2S9ChRZ0QgYCH4EpAUK7KyVP-VwS4tTQhChdsGkA7h0sQNj0fjNvj-tDiAre66zzY6hIsKAdB-1/pub?gid=1978474466&single=true&output=csv"
    ];

    let allProducts = [];

    function fetchSheet(url) {
      return new Promise((resolve, reject) => {
        Papa.parse(url, {
          download: true,
          header: true,
          complete: results => resolve(results.data),
          error: err => reject(err)
        });
      });
    }

    async function loadAllSheets() {
      let promises = sheetUrls.map(url => fetchSheet(url));
      let results = await Promise.all(promises);
      allProducts = results.flat();
      renderProducts(allProducts);
      populateSizeFilter(allProducts);
    }

    function renderProducts(products) {
      const container = document.getElementById("product-list");
      container.innerHTML = "";

      products.forEach(p => {
        if (!p.Name) return; // skip empty rows
        let sizes = [];
        for (let key in p) {
          if (key.toLowerCase().includes("size") && p[key]) {
            sizes.push(`${key}: $${p[key]}`);
          }
        }

        const div = document.createElement("div");
        div.className = "product";
        div.innerHTML = `
          <h3>${p.Name}</h3>
          <p>${p.Description || ""}</p>
          <div class="sizes">${sizes.join("<br>")}</div>
        `;
        container.appendChild(div);
      });
    }

    function populateSizeFilter(products) {
      const sizeFilter = document.getElementById("sizeFilter");
      let sizes = new Set();
      products.forEach(p => {
        for (let key in p) {
          if (key.toLowerCase().includes("size") && p[key]) {
            sizes.add(key);
          }
        }
      });

      sizes.forEach(size => {
        let option = document.createElement("option");
        option.value = size;
        option.textContent = size;
        sizeFilter.appendChild(option);
      });
    }

    document.getElementById("search").addEventListener("input", e => {
      const query = e.target.value.toLowerCase();
      const filtered = allProducts.filter(p => p.Name && p.Name.toLowerCase().includes(query));
      renderProducts(filtered);
    });

    document.getElementById("sizeFilter").addEventListener("change", e => {
      const size = e.target.value;
      if (!size) {
        renderProducts(allProducts);
      } else {
        const filtered = allProducts.filter(p => p[size]);
        renderProducts(filtered);
      }
    });

    loadAllSheets();
  </script>
</body>
</html>
